function createXmlHttpRequest(){try{if("undefined"!=typeof ActiveXObject)return new ActiveXObject("Microsoft.XMLHTTP");if(window.XMLHttpRequest)return new XMLHttpRequest}catch(e){changeStatus(e)}return null}function downloadUrl(e,o){var t=-1,a=createXmlHttpRequest();if(!a)return!1;a.onreadystatechange=function(){if(4==a.readyState){try{t=a.status}catch(e){}200!=t&&0!=t||(o(a.responseText,a.status),a.onreadystatechange=function(){})}},a.open("GET",e,!0);try{a.send(null)}catch(e){changeStatus(e)}}function xmlParse(e){if("undefined"!=typeof ActiveXObject&&"undefined"!=typeof GetObject){var o=new ActiveXObject("Microsoft.XMLDOM");return o.loadXML(e),o}return"undefined"!=typeof DOMParser?(new DOMParser).parseFromString(e,"text/xml"):createElement("div",null)}function downloadScript(e){var o=document.createElement("script");o.src=e,document.body.appendChild(o)}function apf_single_map(){var e=jQuery,o=parseFloat(e("#map_single").data("lat")),t=parseFloat(e("#map_single").data("lng")),a=new google.maps.LatLng(o,t),n={zoom:18,center:a,mapTypeId:google.maps.MapTypeId.ROADMAP,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.LEFT_BOTTOM},panControl:!1,panControlOptions:{position:google.maps.ControlPosition.BOTTOM_RIGHT},mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.BOTTOM_CENTER},streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.LEFT_BOTTOM},scrollwheel:!1,draggable:!0};map=new google.maps.Map(document.getElementById("map_single"),n);var i=new google.maps.MarkerImage(the_hard_men_path+"/modules/advanced-property-framework/img/marker-property.png",null,null,null,new google.maps.Size(50,38));new google.maps.Marker({position:a,map:map,icon:i});google.maps.event.addDomListener(window,"resize",(function(){var e=map.getCenter();google.maps.event.trigger(map,"resize"),map.setCenter(e)})),(new google.maps.TransitLayer).setMap(map)}function apf_update_properties_ajax(){var e=jQuery;e("#apf_update_properties").html('<p>1. Generating import file from Reapit.</p><svg width="44" height="44" viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg" stroke="#b70e0c"> <g fill="none" fill-rule="evenodd" stroke-width="2"> <circle cx="22" cy="22" r="1"> <animate attributeName="r" begin="0s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite" /> <animate attributeName="stroke-opacity" begin="0s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite" /> </circle> <circle cx="22" cy="22" r="1"> <animate attributeName="r" begin="-0.9s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite" /> <animate attributeName="stroke-opacity" begin="-0.9s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite" /> </circle></g></svg>'),e.ajax({url:apf_ajax_object.ajax_url,dataType:"html",type:"POST",async:!0,data:{action:"apf_update_properties_ajax",apf_security:apf_ajax_object.ajax_nonce},success:function(o){e("#apf_update_properties").html(o),apf_update_properties_ajax_2()}})}function apf_update_properties_ajax_2(){var e=jQuery;e("#apf_update_properties").append('<p class="apf__update__running">2. Running import.</p><svg width="44" height="44" viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg" stroke="#b70e0c"> <g fill="none" fill-rule="evenodd" stroke-width="2"> <circle cx="22" cy="22" r="1"> <animate attributeName="r" begin="0s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite" /> <animate attributeName="stroke-opacity" begin="0s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite" /> </circle> <circle cx="22" cy="22" r="1"> <animate attributeName="r" begin="-0.9s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite" /> <animate attributeName="stroke-opacity" begin="-0.9s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite" /> </circle></g></svg>'),setTimeout((function(){e(".apf__update__running").text("Patience my young padawan. Still running.")}),1e4),setTimeout((function(){e(".apf__update__running").text("Put the kettle on?")}),2e4),setTimeout((function(){e(".apf__update__running").text("(Sip) Aaah much better!")}),3e4),setTimeout((function(){e(".apf__update__running").text("Pub?")}),4e4),setTimeout((function(){e(".apf__update__running").text("Is it Friday yet?")}),5e4),setTimeout((function(){e(".apf__update__running").text("Blimey! I'm just a website and even I am getting bored.")}),6e4),setTimeout((function(){e(".apf__update__running").text("Time to call Alex? He is awesome, he can fix this. Nah it's working, just give it a bit more time.")}),12e4),setTimeout((function(){e(".apf__update__running").text("Alright, maybe call Alex now.")}),6e5),e.ajax({url:apf_ajax_object.ajax_url,dataType:"html",type:"POST",async:!0,data:{action:"apf_update_properties_ajax_2",apf_security:apf_ajax_object.ajax_nonce},success:function(o){e("#apf_update_properties").html(o),e("a.apf__update__trigger").removeClass("disabled").text("Update now")}})}jQuery(document).ready((function(e){if(e(".apf__results__map__wrap").length>0);})),jQuery(document).ready((function(e){})),function(e,o,t){var a='<option value="50000">&pound;50,000</option><option value="75000">&pound;75,000</option><option value="100000">&pound;100,000</option><option value="125000">&pound;125,000</option><option value="150000">&pound;150,000</option><option value="175000">&pound;175,000</option><option value="200000">&pound;200,000</option><option value="300000">&pound;300,000</option><option value="400000">&pound;400,000</option><option value="500000">&pound;500,000</option><option value="750000">&pound;750,000</option><option value="1000000">&pound;1,000,000</option><option value="1500000">&pound;1,500,000</option><option value="2000000">&pound;2,000,000</option><option value="2500000">&pound;2,500,000</option><option value="3000000">&pound;3,000,000</option><option value="3500000">&pound;3,500,000</option><option value="4000000">&pound;4,000,000</option><option value="4500000">&pound;4,500,000</option><option value="5000000">&pound;5,000,000</option>',n='<option value="100">&pound;100 per annum</option><option value="200">&pound;200 per annum</option><option value="300">&pound;300 per annum</option><option value="400">&pound;400 per annum</option><option value="500">&pound;500 per annum</option><option value="600">&pound;600 per annum</option><option value="700">&pound;700 per annum</option><option value="800">&pound;800 per annum</option><option value="900">&pound;900 per annum</option><option value="1000">&pound;1,000 per annum</option><option value="1250">&pound;1,250 per annum</option><option value="1500">&pound;1,500 per annum</option><option value="1750">&pound;1,750 per annum</option><option value="2000">&pound;2,000 per annum</option><option value="2250">&pound;2,250 per annum</option><option value="2500">&pound;2,500 per annum</option><option value="2750">&pound;2,750 per annum</option><option value="3000">&pound;3,000 per annum</option>';function i(){switch(e(".apf-search-type").find("input:checked").val()){case"to-let":e("#apf_minprice").html('<option value="">No min</option>'+n),e("#apf_maxprice").html('<option value="">No max</option>'+n);break;default:e("#apf_minprice").html('<option value="">No min</option>'+a),e("#apf_maxprice").html('<option value="">No max</option>'+a)}}function p(o){var t=e("#apf_search"),a=e().jsStorage("apf_search"),n=function(e,o){switch(o){case"object":return e.serializeJSON();case"array":return e.serializeArray();default:return e.serialize()}}(t,"object");if(o)if(o.hasClass("apf-paginate")){var p=o.data("apf-page"),r=a.get();e.extend(r,{apf_page:p}),a.set(r)}else a.set(n);else{var l=window.location.search;l&&(l=l.substr(1),l=e().urlParamsAsObject(l),a.set(l))}a.get()||a.set(n);r=a.get();var s=new URLSearchParams(r).toString();return o&&o.hasClass("apf-json")||history.replaceState({id:"apf_url"},"","?"+s),function(o){e.each(o,(function(o,t){var a=e('[name="'+o+'"]');if(a.length>0)switch(e(a)[0].tagName){case"INPUT":e(a).is(":radio")&&e(a).val()!=t?e(a).trigger("click"):e(a).is(":checkbox")&&e(a).val()===t?e(a).attr("checked","checked"):e(a).is(":text")&&e(a).val(t);break;case"SELECT":e(a).val(t)}})),i()}(r),{dataStore:a,jsonData:r,stringData:s}}function r(o){var t=e(".apf__properties");o.dataStore.getProp("apf_market"),o.dataStore.getProp("apf_dept"),o.dataStore.getProp("apf_location"),o.dataStore.getProp("apf_minprice"),o.dataStore.getProp("apf_maxprice"),o.dataStore.getProp("apf_maxprice"),o.dataStore.getProp("apf_minbeds"),o.dataStore.getProp("apf_maxbeds"),o.dataStore.getProp("apf_view"),o.dataStore.getProp("apf_order"),o.dataStore.getProp("apf_status"),o.dataStore.getProp("apf_branch"),o.dataStore.getProp("apf_page");t.html(e().skeleton('<article class="skeleton"><div class="apf__property__border"><a class="apf__property__img"></a><div class="apf__property__details__wrap"><div class="apf__property__details"><h3></h3><h5></h5><p></p></div><div class="apf__property__meta"><div class="apf__property__meta__data"><span></span><span></span><span></span></div><a></a></div></div></div></article>')),e.ajax({url:apf_ajax_object.ajax_url,dataType:"html",type:"POST",data:{action:"apf_property_search",apf_security:apf_ajax_object.ajax_nonce,search_data:o.jsonData},success:function(e){t.html(e);new Blazy({selector:".blazy"})}}),function(o){e("#apf_map").html("").addClass("skeleton"),e.ajax({url:apf_ajax_object.ajax_url,dataType:"JSON",type:"POST",data:{action:"apf_map",ajax_security:apf_ajax_object.ajax_nonce,search_data:o},success:function(o){!function(o){var t=new google.maps.LatLng(51.507425,-.127651),a=new google.maps.Map(document.getElementById("apf_map"),{center:t,zoom:11,mapTypeId:"roadmap",mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.CENTER_BOTTOM},zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.TOP_LEFT},streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.TOP_LEFT},scrollwheel:!1,styles:[{featureType:"administrative",elementType:"all",stylers:[{visibility:"simplified"},{color:"#5b6571"},{lightness:"35"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f3f4f4"}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{weight:.9},{visibility:"on"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#83cead"}]},{featureType:"road",elementType:"all",stylers:[{color:"#ffffff"}]},{featureType:"road.highway",elementType:"all",stylers:[{color:"#fee379"}]},{featureType:"road.arterial",elementType:"all",stylers:[{color:"#ffffff"}]},{featureType:"water",elementType:"all",stylers:[{visibility:"on"},{color:"#7fc8ed"}]}]}),n=[],i=(new google.maps.InfoWindow,new google.maps.LatLngBounds),p=new google.maps.MarkerImage(apf_ajax_object.apf_path+"/img/marker-property.png",null,null,null,new google.maps.Size(50,38)),r=new google.maps.MarkerImage(apf_ajax_object.apf_path+"/img/marker-property-hover.png",null,null,null,new google.maps.Size(60,46));function l(o,t,i,l){var s=new google.maps.Marker({position:o,icon:p,map:a,title:t});s.myname=t,s.myicon=l,n.push(s),google.maps.event.addListener(s,"click",(function(){for(var o=0;o<n.length;o++)n[o].setIcon(p);s.setIcon(r),e("#infowindow").addClass("open"),e("#infowindow").removeClass("closed empty"),e("#infowindow").empty(),e("#infowindow").append(i)}))}downloadUrl(apf_ajax_object.apf_properties_map_url+"?posts="+o,(function(e){for(var o=xmlParse(e).documentElement.getElementsByTagName("marker"),t=0;t<o.length;t++){var n=parseFloat(o[t].getAttribute("lat")),p=parseFloat(o[t].getAttribute("lng")),r=new google.maps.LatLng(n,p),s=o[t].getAttribute("permalink"),u=o[t].getAttribute("name"),c=o[t].getAttribute("price"),d=o[t].getAttribute("type"),m=o[t].getAttribute("status"),_=o[t].getAttribute("seo"),f='<div class="infowindow"><div class="infowindow__img"><a href="#" title="Close" class="infowindow-close"><i class="fal fa-times"></i></a><a href="'+s+'" title="Click for full details on '+u+'"><img src="'+o[t].getAttribute("image")+'" alt="'+u+'"></a></div><h3><a href="'+s+'" title="Click for full details on '+u+'">&pound;'+c+("to-let"==d?" <small>PW</small>":"")+"</a>"+(""!==m?"<span>"+m+"</span>":"")+'</h3><div class="infowindow__content"><h5>'+_+"</h5><p>"+u.replace(/,/g,"<br>")+'</p><p class="infowindow__content__name-mobile">'+u+'</p><a href="'+s+'" title="Click for full details on '+u+'" class="infowindow__fom">Full details</a></div></div>';l(r,u,f);i.extend(r)}a.fitBounds(i)})),google.maps.event.addDomListener(window,"resize",(function(){var e=a.getCenter();google.maps.event.trigger(a,"resize"),a.setCenter(e)})),google.maps.event.addListener(a,"click",(function(){for(var o=0;o<n.length;o++)n[o].setIcon(p);e("#infowindow").empty(),e("#infowindow").removeClass("open"),e("#infowindow").addClass("closed empty")})),e("#infowindow").on("click","a.infowindow-close",(function(o){o.preventDefault();for(var t=0;t<n.length;t++)n[t].setIcon(p);e("#infowindow").empty(),e("#infowindow").removeClass("open"),e("#infowindow").addClass("closed empty")})),(new google.maps.TransitLayer).setMap(a),google.maps.event.addListenerOnce(a,"idle",(function(){setTimeout((function(){e(".apf__properties article").hover((function(){var o=e(".apf__properties article").index(this);n[o].setIcon(r)}),(function(){var o=e(".apf__properties article").index(this);n[o].setIcon(p)}))}),2e3)})),e(window).width()<900&&a.setOptions({mapTypeControl:!1,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.RIGHT_TOP},streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP}})}(o.toString()),e("#apf_map").removeClass("skeleton")},error:function(e){console.error(e)}})}(o.jsonData)}e(window).on("load",(function(){var o;i(),function(){if(e(".apf__results").length>0){r(p())}}(),e(document).on("click",".apf-fetch",(function(t){"BUTTON"!==t.target.tagName&&"BUTTON"!==e(t.target).parent()[0].tagName||t.preventDefault();var a=p(e(this));e(this).hasClass("apf-json")?window.location.replace(apf_ajax_object.apf_page):(clearTimeout(o),o=setTimeout(()=>{r(a)},100))})),e(document).on("click",".apf-view-on-change",(function(t){clearTimeout(o),o=setTimeout(()=>{!function(o){switch(o.data("view")){case"list":e(".apf__properties").addClass("list");break;case"map":e(".apf__results").toggleClass("apf__map__hidden");break;default:e(".apf__properties").removeClass("list")}}(e(this))},100)})),e(document).on("click",".apf-search-type label",(function(e){clearTimeout(o),o=setTimeout(()=>{i()},100)})),e(document).on("click",".apf-paginate",(function(o){r(p(e(this)))})),e(".apf__filter__order").change((function(){clickedEl=e(this),r(p(e(this)))})),e(".apf__filter__branch").change((function(){clickedEl=e(this),r(p(e(this)))}))}))}(jQuery),jQuery(document).ready((function(e){var o=new URLSearchParams(location.search);e(".apf__book__viewing__button").click((function(o){o.preventDefault(),e(".apf__book__viewing__form.view").addClass("open"),e("body").addClass("no__scroll")})),e(".apf__book__viewing.close").click((function(o){o.preventDefault(),e(".apf__book__viewing__form").removeClass("open"),e("body").removeClass("no__scroll")})),"true"==o.get("book")&&e(".apf__book__viewing__button").trigger("click")})),jQuery(document).ready((function(e){if(e("#map_single").length>0)new Blazy({selector:"#map_single",success:function(e){apf_single_map()}})})),jQuery(document).ready((function(e){jQuery(document).on("click",".apf__update__trigger",(function(o){o.preventDefault(),e(this).addClass("disabled").text("Updating"),apf_update_properties_ajax()}))})),function(e,o,t){function a(){return 1===e("#apf_branches_map").length}e(window).on("load",(function(){a()&&(!function(){if(a()){var o=new google.maps.LatLng(50.694593,-1.302594),t=new google.maps.Map(document.getElementById("apf_branches_map"),{center:o,zoom:11,mapTypeId:"roadmap",mapTypeControl:!0,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.CENTER_BOTTOM},zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.TOP_LEFT},streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.TOP_LEFT},scrollwheel:!1}),n=[],i=(new google.maps.InfoWindow,new google.maps.LatLngBounds),p=new google.maps.MarkerImage(apf_ajax_object.apf_path+"img/marker-property.png",null,null,null,new google.maps.Size(50,38)),r=new google.maps.MarkerImage(apf_ajax_object.apf_path+"img/marker-property-hover.png",null,null,null,new google.maps.Size(60,46));function l(o,a,i,l){var s=new google.maps.Marker({position:o,icon:p,map:t,title:a});s.myname=a,s.myicon=l,n.push(s),google.maps.event.addListener(s,"click",(function(){for(var o=0;o<n.length;o++)n[o].setIcon(p);s.setIcon(r),e("#infowindow").addClass("open"),e("#infowindow").removeClass("closed empty"),e("#infowindow").empty(),e("#infowindow").append(i)}))}downloadUrl(apf_ajax_object.apf_branches_map_url,(function(e){for(var o=xmlParse(e).documentElement.getElementsByTagName("marker"),a=0;a<o.length;a++){var n=parseFloat(o[a].getAttribute("lat")),p=parseFloat(o[a].getAttribute("lng")),r=new google.maps.LatLng(n,p),s=o[a].getAttribute("permalink"),u=o[a].getAttribute("name"),c=o[a].getAttribute("address");l(r,u,'<div class="infowindow"><div class="infowindow__img"><a href="#" title="Close" class="infowindow-close"><i class="fal fa-times"></i></a><a href="'+s+'" title="Click for full details on '+u+'"><img src="'+o[a].getAttribute("image")+'" alt="'+u+'"></a></div><div class="infowindow__content"><h5>'+u+"</h5>"+(""!==c?"<p>"+c.replace(/,/g,"<br>")+"</p>":"")+'<p class="infowindow__content__name-mobile">'+u+'</p><a href="'+s+'" title="Click for full details on '+u+'" class="infowindow__fom">Full details</a></div></div>');i.extend(r)}t.fitBounds(i)})),google.maps.event.addDomListener(window,"resize",(function(){var e=t.getCenter();google.maps.event.trigger(t,"resize"),t.setCenter(e)})),google.maps.event.addListener(t,"click",(function(){for(var o=0;o<n.length;o++)n[o].setIcon(p);e("#infowindow").empty(),e("#infowindow").append('<p class="empty-text">Tap on a property to preview its details.</p>'),e("#infowindow").removeClass("open"),e("#infowindow").addClass("closed empty")})),e("#infowindow").on("click","a.infowindow-close",(function(o){o.preventDefault();for(var t=0;t<n.length;t++)n[t].setIcon(p);e("#infowindow").empty(),e("#infowindow").append('<p class="empty-text">Tap on a property to preview its details.</p>'),e("#infowindow").removeClass("open"),e("#infowindow").addClass("closed empty")})),(new google.maps.TransitLayer).setMap(t),e(window).width()<900&&t.setOptions({mapTypeControl:!1,zoomControl:!0,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:google.maps.ControlPosition.RIGHT_TOP},streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.RIGHT_TOP}})}}(),e(".apf__map__hide").on("click",(function(o){e(this).toggleClass("active"),e(".apf__results").toggleClass("apf__map__hidden")})),e(".apf__switch__view__mobile").on("click",(function(o){o.preventDefault(),e(".apf__results__map__wrap").removeAttr("style"),e(".apf__results__map").toggleClass("apf__results__map__active")})))}))}(jQuery),jQuery(document).ready((function(e){new Blazy({selector:".blazy"});e(".property__gallery").lightSlider({item:1,loop:!1,easing:"cubic-bezier(0.25, 0, 0.25, 1)",enableDrag:!1,gallery:!0,thumbItem:6,slideMargin:0,onSliderLoad:function(e){e.lightGallery({selector:".property__gallery .property__gallery__slide",download:!1,hash:!1})}}),e(".property__gallery__all").lightGallery({hash:!1,selector:".property__gallery__all li",fullScreen:!1,download:!1})}));